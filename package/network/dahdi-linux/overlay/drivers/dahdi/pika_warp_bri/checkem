#!/bin/sh

DIR=`dirname $0`
cd $DIR

RELEASE=`uname -r`
CHECKPATCH=/lib/modules/$RELEASE/build/scripts/checkpatch.pl
if [ ! -x $CHECKPATH ] ; then
    CHECKPATCH=/lib/modules/$RELEASE/source/scripts/checkpatch.pl
    [ -x $CHECKPATCH ] || CHECKPATCH=checkpatch
fi

for f in `ls *.[ch]`; do
	# warped24succ.h is autogenerated
	[ $f = warped24succ.h ] && continue
	$CHECKPATCH --file $f >/dev/null || echo "$DIR/$f failed."
done
